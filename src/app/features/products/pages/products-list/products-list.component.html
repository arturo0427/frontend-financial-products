<section class="page">
  <header class="page__header">
    <h1 class="title">Productos Financieros</h1>

    <button class="btn btn--primary" type="button" (click)="goToCreate()">
      Agregar
    </button>
  </header>

  <div class="card">
    <div class="toolbar">
      <div class="field">
        <input
          id="search"
          class="input"
          type="text"
          [value]="searchTerm()"
          (input)="onSearchChange($any($event.target).value)"
          placeholder="Escribe para buscar..."
          autocomplete="off"
        />
      </div>
    </div>

    @if (isLoading()) {
      <div class="state state--loading">Cargando productos...</div>
    } @else if (error()) {
      <div class="state state--error">
        <div class="state__title">Error</div>
        <div class="state__message">{{ error()!.message }}</div>
        <button class="btn btn--ghost" type="button" (click)="loadProducts()">
          Reintentar
        </button>
      </div>
    } @else {
      @if (visibleProducts().length === 0) {
        <div class="state">No se encontraron resultados.</div>
      } @else {
        <app-table
          [items]="visibleProducts()"
          (edit)="onEdit($event)"
          (remove)="onDelete($event)"
        />

        <div class="table__footer">
          <div class="results">{{ totalFilteredCount() }} Resultados</div>

          <div class="field field--small footer__size">
            <label class="label" for="pageSize">Mostrar</label>
            <select
              id="pageSize"
              class="select"
              [value]="pageSize()"
              (change)="onPageSizeChange($any($event.target).value)"
            >
              <option value="5">5</option>
              <option value="10">10</option>
              <option value="20">20</option>
            </select>
          </div>
        </div>
      }
    }
  </div>
</section>
